# 14_FINAL_SYSTEM_LANDSCAPE.md

## üåç The Zepix Trading Bot v3.0 - System Landscape
*Autonomously Generated by Zepix Archetype Agent - December 2025*

This document represents the **ULTIMATE TRUTH** of the codebase, verified by broad-spectrum simulation.

### 1. üß† Core Management Layer (Managers)

| Manager | Responsibility | Actual File Location | Key Features Verified |
| :--- | :--- | :--- | :--- |
| **AutonomousSystemManager** | `src/managers/autonomous_system_manager.py` | Orchestration | Logic Selection, Auto-Trading Cycle |
| **DualOrderManager** | `src/managers/dual_order_manager.py` | Order Placement | **Smart Lot Adjustment** (Risk-based resizing), Dual Orders (A/B) |
| **ProfitBookingManager** | `src/managers/profit_booking_manager.py` | Compound Growth | **Profit Chain**: Levels 0-4, Multiplier Scaling (Money Printer) |
| **ProfitProtectionManager** | `src/managers/profit_protection_manager.py` | Guard Rails | **Profit Locking** (Moves SL to Entry+10pips), Recovery Blocking Decisions |
| **ReEntryManager** | `src/managers/reentry_manager.py` | Recovery Setup | SL Hunt detection logic |
| **RiskManager** | `src/managers/risk_manager.py` | Safety & Caps | Daily Loss Limit, Lifetime Cap, Tiered Risk |
| **ReverseShieldManager** | `src/managers/reverse_shield_manager.py` | Hedging | Reversal detection & hedging orders |
| **TimeframeTrendManager** | `src/managers/timeframe_trend_manager.py` | Trend Filter | HTF EMA alignment checks |
| **SessionManager** | `src/managers/session_manager.py` | Timing | Session-based (London/NY) logic |
| **RecoveryWindowMonitor** | `src/managers/recovery_window_monitor.py` | Timing | Specific windows for recovery attempts |
| **ExitContinuationMonitor** | `src/managers/exit_continuation_monitor.py` | re-entry | Continuation logic after manual/algo exits |
| **SLReductionOptimizer** | `src/managers/sl_reduction_optimizer.py` | Optimization | Dynamic SL reduction based on volatility |

---

### 2. üëÅÔ∏è The Watchman Layer (Services)

| Service | Responsibility | Actual File Location | Key Features Verified |
| :--- | :--- | :--- | :--- |
| **PriceMonitorService** | `src/services/price_monitor_service.py` | **The Heartbeat** | 2s Polling Loop. Triggers: SL Hunt, TP Continuation, Profit Booking, Margin Check (Disabled) |
| **ReversalExitHandler** | `src/services/reversal_exit_handler.py` | Exit Signals | Handles external/internal exit signals |
| **AnalyticsEngine** | `src/services/analytics_engine.py` | Stats | Performance metrics calculation |

---

### 3. üîß Utility Layer (Utils)

| Utility | Responsibility | Actual File Location |
| :--- | :--- | :--- |
| **PipCalculator** | `src/utils/pip_calculator.py` | Pips & Distances (Fixed Inversion Bug) |
| **ProfitSLCalculator** | `src/utils/profit_sl_calculator.py` | Dollar-based SL (Fixed Tuple Return) |
| **ExitStrategies** | `src/utils/exit_strategies.py` | Trailing Stop & Time Exits (Memory-based) |
| **TrendAnalyzer** | `src/utils/trend_analyzer.py` | Market Structure Analysis |
| **OptimizedLogger** | `src/utils/optimized_logger.py` | Async Logging |
| **Logging Config** | `src/utils/logging_config.py` | Log Rotation & Formatting |

---

### 4. üîó Connectivity Layer

| Component | Responsibility | Actual File Location |
| :--- | :--- | :--- |
| **TradingEngine** | `src/core/trading_engine.py` | Central Orchestrator |
| **MT5Client** | `src/clients/mt5_client.py` | Broker Connection (Added `modify_position`) |
| **Database** | `src/database.py` | SQLite Storage |
| **TelegramBot** | `src/clients/telegram_bot.py` | User Interface |
| **Config** | `src/config.py` | JSON Configuration |

---

### 5. ‚úÖ Active Feature Set (Certified Verified)
1.  **Dual Order System**: Splits trades into Order A (Trends) and Order B (Compounding).
2.  **Smart Lot Adjustment**: Automatically downsizes lots if Daily Risk Limit is near.
3.  **Profit Protection**: **Confimed** - Moves SL to Breakeven+ when profit thresholds are met.
4.  **Profit Booking Chain**: Levels 0-4 fully operational.
5.  **Watchman Monitoring**: 2s loop detects and triggers events correctly.
6.  **Broker Integration**: MT5 Connection with robust error handling and SL modification.

*This document serves as the final architectural reference for Zepix Trading Bot v3.0.*
